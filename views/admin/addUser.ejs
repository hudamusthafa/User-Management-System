<!DOCTYPE html>
<html>
<head>
  <title>Add User</title>

  <!-- No Cache -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
</head>

<body>

<h2>Add New User</h2>

<!-- Backend validation error -->
<% if (message) { %>
  <p style="color:red;"><%= message %></p>
<% } %>

<form action="/admin/addUser" method="post" onsubmit="return validateForm()">
  
  <label>Email</label><br>
  <input type="email" id="email" name="email">
  <span id="emailError" style="color:red; font-size:14px;"></span>
  <br><br>

  <label>Password</label><br>
  <input type="password" id="password" name="password">
  <span id="passwordError" style="color:red; font-size:14px;"></span>
  <br><br>

  <button type="submit">Save User</button>
</form>

<br>
<a href="/admin/dashboard">Back</a>

<script>
  // ‚≠ê FRONT-END VALIDATION
  function validateForm() {
    let email = document.getElementById("email").value.trim();
    let password = document.getElementById("password").value.trim();

    let emailError = document.getElementById("emailError");
    let passwordError = document.getElementById("passwordError");

    emailError.textContent = "";
    passwordError.textContent = "";

    let valid = true;

    // Email Required
    if (email === "") {
      emailError.textContent = "Email is required";
      valid = false;
    } else {
      // Email Format Validation
      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailPattern.test(email)) {
        emailError.textContent = "Please enter a valid email";
        valid = false;
      }
    }

    // Password Required
    if (password === "") {
      passwordError.textContent = "Password is required";
      valid = false;
    } 
    // OPTIONAL: Minimum length rule
    // else if (password.length < 6) {
    //   passwordError.textContent = "Password must be at least 6 characters long";
    //   valid = false;
    // }

    return valid; // prevent submit if validation fails
  }
</script>

<script>
  // üî• Remove AddUser page from history so BACK never returns here
  history.replaceState(null, "", "/admin/dashboard");
</script>

</body>
</html>
